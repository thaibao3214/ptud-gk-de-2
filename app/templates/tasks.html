{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">Your Tasks</h2>
    
    <!-- Task Form -->
    <form method="POST" class="mb-4">
        {{ form.hidden_tag() }}
        <div class="mb-3">
            {{ form.title.label(class="form-label") }}
            {{ form.title(class="form-control", placeholder="Enter task title") }}
        </div>
        <div class="mb-3">
            {{ form.description.label(class="form-label") }}
            {{ form.description(class="form-control", placeholder="Enter task description") }}
        </div>
        <button type="submit" class="btn btn-primary">Add Task</button>
    </form>
    
    <!-- Task List -->
    <ul class="list-group">
        {% for task in tasks %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                <strong>{{ task.title }}</strong>
                <p class="mb-0 text-muted">{{ task.description }}</p>
            </div>
            <div>
                <form action="{{ url_for('main.toggle_task', task_id=task.id) }}" method="POST" class="d-inline">
                    <button type="submit" class="btn btn-sm {% if task.completed %}btn-success{% else %}btn-secondary{% endif %}">
                        {% if task.completed %}âœ” Completed{% else %}Mark as Done{% endif %}
                    </button>
                </form>
                {% if current_user.id == task.user_id or current_user.is_admin %}
                    <a href="{{ url_for('main.edit_task', task_id=task.id) }}" class="btn btn-warning btn-sm">Edit</a>
                    <form action="{{ url_for('main.delete_task', task_id=task.id) }}" method="POST" class="d-inline" onsubmit="return confirm('Are you sure?');">
                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                    </form>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}