{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<h2>Quản lý Users</h2>
<table>
    <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Role</th>
        <th>Trạng thái</th>
        <th>Actions</th>
    </tr>
    {% for user in users %}
    <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.role }}</td>
        <td>
            {% if user.is_active %} Hoạt động {% else %} Bị khóa {% endif %}
        </td>
        <td>
            {% if user.role != 'admin' %}
                <form action="{{ url_for('admin.delete_user', user_id=user.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger">Xóa</button>
                </form>
                {% if user.is_active %}
                    <form action="{{ url_for('admin.lock_user', user_id=user.id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn btn-warning">Khóa</button>
                    </form>
                {% else %}
                    <form action="{{ url_for('admin.unlock_user', user_id=user.id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn btn-success">Mở khóa</button>
                    </form>
                {% endif %}
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

<h2>Quản lý Bài viết</h2>
<table>
    <tr>
        <th>ID</th>
        <th>Tiêu đề</th>
        <th>Tác giả</th>
        <th>Actions</th>
    </tr>
    {% for post in posts %}
    <tr>
        <td>{{ post.id }}</td>
        <td>{{ post.title }}</td>
        <td>{{ post.user.username }}</td>
        <td>
            <form action="{{ url_for('admin.delete_post_admin', post_id=post.id) }}" method="POST">
                <button type="submit" class="btn btn-danger">Xóa</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}